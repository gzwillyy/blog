{"title":"Mysql 之 使用 Prometheus 和 Grafana 监控 MySQL 性能","uid":"07709a5ec8fca245e3ed20c42a15171e","slug":"mysql-prometheus-grafana-build","date":"2023-01-22T13:58:26.000Z","updated":"2023-01-22T13:58:26.000Z","comments":true,"path":"api/articles/mysql-prometheus-grafana-build.json","keywords":null,"cover":"https://images.unsplash.com/photo-1489875347897-49f64b51c1f8","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>请注意，这只是一个简单搭建教程，具体应用还需要根据实际情况来调整。</p></blockquote>\n<h2 id=\"基础环境\"><a href=\"#基础环境\" class=\"headerlink\" title=\"基础环境\"></a>基础环境</h2><table>\n<thead>\n<tr>\n<th>环境&#x2F;组件</th>\n<th>版本</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Mac M1虚拟机</td>\n<td>Centos8</td>\n</tr>\n<tr>\n<td>Prometheus</td>\n<td>2.41.0</td>\n</tr>\n<tr>\n<td>Grafana</td>\n<td>9.3.2</td>\n</tr>\n</tbody></table>\n<h2 id=\"1-Prometheus-安装与配置\"><a href=\"#1-Prometheus-安装与配置\" class=\"headerlink\" title=\"1. Prometheus 安装与配置\"></a>1. Prometheus 安装与配置</h2><h3 id=\"Prometheus-下载\"><a href=\"#Prometheus-下载\" class=\"headerlink\" title=\"Prometheus 下载\"></a>Prometheus 下载</h3><h4 id=\"Prometheus-的官方网站\"><a href=\"#Prometheus-的官方网站\" class=\"headerlink\" title=\"Prometheus 的官方网站\"></a>Prometheus 的官方网站</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">https:&#x2F;&#x2F;prometheus.io<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Prometheus-安装\"><a href=\"#Prometheus-安装\" class=\"headerlink\" title=\"Prometheus 安装\"></a>Prometheus 安装</h3><h4 id=\"Prometheus-安装的命令行语句\"><a href=\"#Prometheus-安装的命令行语句\" class=\"headerlink\" title=\"Prometheus 安装的命令行语句\"></a>Prometheus 安装的命令行语句</h4><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> ~\n<span class=\"token function\">mkdir</span> prometheus <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> prometheus\nwegt https://github.com/prometheus/prometheus/releases/download/v2.41.0/prometheus-2.41.0.linux-arm64.tar.gz\n<span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> prometheus-2.41.0.linux-arm64.tar.gz\n./prometheus<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"2-Grafana-安装与配置\"><a href=\"#2-Grafana-安装与配置\" class=\"headerlink\" title=\"2. Grafana 安装与配置\"></a>2. Grafana 安装与配置</h2><h3 id=\"Grafana-下载\"><a href=\"#Grafana-下载\" class=\"headerlink\" title=\"Grafana 下载\"></a>Grafana 下载</h3><h4 id=\"Grafana-的官方网站\"><a href=\"#Grafana-的官方网站\" class=\"headerlink\" title=\"Grafana 的官方网站\"></a>Grafana 的官方网站</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">https:&#x2F;&#x2F;grafana.com<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"Grafana-安装\"><a href=\"#Grafana-安装\" class=\"headerlink\" title=\"Grafana 安装\"></a>Grafana 安装</h3><h4 id=\"Grafana-安装的命令行语句\"><a href=\"#Grafana-安装的命令行语句\" class=\"headerlink\" title=\"Grafana 安装的命令行语句\"></a>Grafana 安装的命令行语句</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">docker pull grafana&#x2F;grafana-oss:9.3.2-ubuntu@sha256:e76c86b351aadc13a748ac05937110a69d659b426ca59e0d824a325170ca75fd\ndocker run -d --net host --name&#x3D;grafana -e &quot;GF_INSTALL_PLUGINS&#x3D;grafana-clock-panel,grafana-simple-json-datasource&quot; -p 3000:3000 77a68ddee903<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"3-mysql-exporter-安装与配置\"><a href=\"#3-mysql-exporter-安装与配置\" class=\"headerlink\" title=\"3. mysql_exporter 安装与配置\"></a>3. mysql_exporter 安装与配置</h2><h3 id=\"mysql-exporter-下载\"><a href=\"#mysql-exporter-下载\" class=\"headerlink\" title=\"mysql_exporter 下载\"></a>mysql_exporter 下载</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">wget https:&#x2F;&#x2F;github.com&#x2F;prometheus&#x2F;mysqld_exporter&#x2F;releases&#x2F;download&#x2F;v0.14.0&#x2F;mysqld_exporter-0.14.0.linux-arm64.tar.gz\ntar -zxvf mysqld_exporter-0.14.0.linux-arm64.tar.gz\ncd mysqld_exporter-0.14.0.linux-arm64\nvim .my.cnf\n\n[client]\nhost&#x3D;127.0.0.1\nport&#x3D;3306\nuser&#x3D;mysqld_exporter\npassword&#x3D;mysqld_exporter\n\n.&#x2F;mysqld_exporter --config.my-cnf&#x3D;&#x2F;root&#x2F;prometheus&#x2F;mysql_exporter&#x2F;mysqld_exporter-0.14.0.linux-arm64&#x2F;.my.cnf\n\nvi &#x2F;root&#x2F;prometheus&#x2F;prometheus-2.41.0.linux-arm64&#x2F;prometheus.yml\n\n- job_name: &#39;mysqld-node&#39;\n    static_configs:\n    - targets: [&#39;192.168.1.235:9104&#39;]\n      labels:\n        instance: mysqld-node1\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"Grafana-配置监控面板\"><a href=\"#Grafana-配置监控面板\" class=\"headerlink\" title=\"Grafana 配置监控面板\"></a>Grafana 配置监控面板</h3><h4 id=\"Grafana-中创建-mysql-exporter-监控面板\"><a href=\"#Grafana-中创建-mysql-exporter-监控面板\" class=\"headerlink\" title=\"Grafana 中创建 mysql_exporter 监控面板\"></a>Grafana 中创建 mysql_exporter 监控面板</h4><p><strong>导入mysqld_exporter仪表板 ID 7362 ,修改名称 加载</strong></p>\n<hr>\n","feature":false,"text":" 请注意，这只是一个简单搭建教程，具体应用还需要根据实际情况来调整。 基础环境 环境&#x2F;组件 版本 Mac M1虚拟机 Centos8 Prometheus 2.41.0 Grafana 9.3.2 1. Prometheus 安装与配置Prometheus 下载Prom...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"Mysql","slug":"Mysql","count":1,"path":"api/categories/Mysql.json"}],"tags":[{"name":"Prometheus","slug":"Prometheus","count":1,"path":"api/tags/Prometheus.json"},{"name":"Grafana","slug":"Grafana","count":1,"path":"api/tags/Grafana.json"},{"name":"监控","slug":"监控","count":1,"path":"api/tags/监控.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">基础环境</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-Prometheus-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">1. Prometheus 安装与配置</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Prometheus-%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">Prometheus 下载</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Prometheus-%E7%9A%84%E5%AE%98%E6%96%B9%E7%BD%91%E7%AB%99\"><span class=\"toc-text\">Prometheus 的官方网站</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Prometheus-%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">Prometheus 安装</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Prometheus-%E5%AE%89%E8%A3%85%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">Prometheus 安装的命令行语句</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-Grafana-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">2. Grafana 安装与配置</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Grafana-%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">Grafana 下载</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Grafana-%E7%9A%84%E5%AE%98%E6%96%B9%E7%BD%91%E7%AB%99\"><span class=\"toc-text\">Grafana 的官方网站</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Grafana-%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">Grafana 安装</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Grafana-%E5%AE%89%E8%A3%85%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">Grafana 安装的命令行语句</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-mysql-exporter-%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">3. mysql_exporter 安装与配置</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#mysql-exporter-%E4%B8%8B%E8%BD%BD\"><span class=\"toc-text\">mysql_exporter 下载</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Grafana-%E9%85%8D%E7%BD%AE%E7%9B%91%E6%8E%A7%E9%9D%A2%E6%9D%BF\"><span class=\"toc-text\">Grafana 配置监控面板</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Grafana-%E4%B8%AD%E5%88%9B%E5%BB%BA-mysql-exporter-%E7%9B%91%E6%8E%A7%E9%9D%A2%E6%9D%BF\"><span class=\"toc-text\">Grafana 中创建 mysql_exporter 监控面板</span></a></li></ol></li></ol></li></ol>","author":{"name":"G","slug":"blog-author","avatar":"https://froggyfriends.mypinata.cloud/ipfs/QmaTJi8B2cH5QKiXz1XneEuDaL1WC71uuq2A1X9t4sfacT","link":"/","description":"一位正在重塑知识的技术人 <br />","socials":{"github":"https://github.com/gzwillyy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"telegram":{"icon":"/svg/telegram.svg","link":"https://t.me/gzwilly"}}}},"mapped":true,"prev_post":{"title":"Go语言项目开发规范 之 代码规范","uid":"e386f25fe35d3cc208c03de6e86811c8","slug":"go-code-lint","date":"2023-02-02T12:50:39.000Z","updated":"2023-02-02T12:50:39.000Z","comments":true,"path":"api/articles/go-code-lint.json","keywords":null,"cover":"https://i.328888.xyz/2023/02/03/IKcpL.jpeg","text":" 本文是学习《从零开发企业级 Go 应用》 的内容拷贝 课程链接 Go 代码开发规范在Go 项目开发中，一个好的编码规范可以极大的提高代码质量。为了帮你节省时间和精力，这里我整理了一份清晰、可直接套用的 Go 编码规范，供你参考。 这份规范，是我参考了 Go 官方提供的编码规范，...","link":"","photos":[],"count_time":{"symbolsCount":"15k","symbolsTime":"13 mins."},"categories":[{"name":"Golang","slug":"Golang","count":8,"path":"api/categories/Golang.json"}],"tags":[{"name":"开发规范","slug":"开发规范","count":7,"path":"api/tags/开发规范.json"},{"name":"Golang","slug":"Golang","count":8,"path":"api/tags/Golang.json"},{"name":"代码规范","slug":"代码规范","count":1,"path":"api/tags/代码规范.json"}],"author":{"name":"G","slug":"blog-author","avatar":"https://froggyfriends.mypinata.cloud/ipfs/QmaTJi8B2cH5QKiXz1XneEuDaL1WC71uuq2A1X9t4sfacT","link":"/","description":"一位正在重塑知识的技术人 <br />","socials":{"github":"https://github.com/gzwillyy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"telegram":{"icon":"/svg/telegram.svg","link":"https://t.me/gzwilly"}}}}},"next_post":{"title":"微服务 之 高可用保障 - 链路追踪、熔断、限流、降级","uid":"8fee980f49138056ea0028cf01eac4d6","slug":"micro-high-availability","date":"2023-01-12T08:40:29.000Z","updated":"2023-01-12T08:40:29.000Z","comments":true,"path":"api/articles/micro-high-availability.json","keywords":null,"cover":"https://images.unsplash.com/photo-1667372459567-3853510dd5ce","text":"微服务是一种将应用程序作为独立服务的集合结构的架构风格。这些服务通过API互相通信，设计为具有高度的可扩展性、灵活性和弹性。为了保证微服务环境的高可用性，实施几个关键策略是非常重要的，包括链路追踪、熔断、限流和降级。 链路追踪链路追踪是追踪请求在应用中穿过不同微服务的路径的能力。...","link":"","photos":[],"count_time":{"symbolsCount":565,"symbolsTime":"1 mins."},"categories":[{"name":"Micro","slug":"Micro","count":3,"path":"api/categories/Micro.json"}],"tags":[{"name":"链路追踪","slug":"链路追踪","count":1,"path":"api/tags/链路追踪.json"},{"name":"熔断","slug":"熔断","count":1,"path":"api/tags/熔断.json"},{"name":"限流","slug":"限流","count":1,"path":"api/tags/限流.json"},{"name":"降级","slug":"降级","count":1,"path":"api/tags/降级.json"}],"author":{"name":"G","slug":"blog-author","avatar":"https://froggyfriends.mypinata.cloud/ipfs/QmaTJi8B2cH5QKiXz1XneEuDaL1WC71uuq2A1X9t4sfacT","link":"/","description":"一位正在重塑知识的技术人 <br />","socials":{"github":"https://github.com/gzwillyy","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"telegram":{"icon":"/svg/telegram.svg","link":"https://t.me/gzwilly"}}}}}}